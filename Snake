<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Classic Snake Game</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }

        canvas {
            border: 20px solid #333;
            background-color: #c5e1a5;
        }

        #score {
            margin: 20px;
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        #controls {
            margin-top: 20px;
            display: grid;
            grid-template-areas: 
                ". up ."
                "left . right"
                ". down .";
            width: 150px;
        }

        .control-btn {
            padding: 15px;
            background-color: #555;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 18px;
            text-align: center;
        }

        #up-btn    { grid-area: up; border-top-left-radius: 8px; border-top-right-radius: 8px; }
        #down-btn  { grid-area: down; border-bottom-left-radius: 8px; border-bottom-right-radius: 8px; }
        #left-btn  { grid-area: left; }
        #right-btn { grid-area: right; }

        /* Restart and Levels Buttons */
        .extra-btn {
            grid-column: span 3;
            margin-top: 5px;
            font-size: 16px;
        }
        #restart-btn { background-color: #2196f3; }
        #level-btn { background-color: #ff9800; }

    </style>
</head>
<body>

    <div id="score">Score: 0</div>
    <canvas id="gameCanvas" width="400" height="400"></canvas>

    <div id="controls">
        <button id="up-btn" class="control-btn" onclick="setDirection('Up')">⬆️</button>
        <button id="left-btn" class="control-btn" onclick="setDirection('Left')">⬅️</button>
        <button id="right-btn" class="control-btn" onclick="setDirection('Right')">➡️</button>
        <button id="down-btn" class="control-btn" onclick="setDirection('Down')">⬇️</button>

        <button id="restart-btn" class="control-btn extra-btn" onclick="restartGame()">Restart</button>
        <button id="level-btn" class="control-btn extra-btn" onclick="chooseLevel()">Levels</button>
    </div>

    <p style="margin-top: 10px; font-size: 14px; color: #666;">
        Use on-screen buttons or Arrow Keys/WASD.
    </p>

    <script>
        // --- GAME VARIABLES ---
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');

        const tileSize = 20;
        const tileCount = canvas.width / tileSize;

        let speed = 3; // Snake moves slowly by default
        let snake = [{ x: 10, y: 10 }];
        let dx = 1, dy = 0, newDx = 1, newDy = 0;
        let score = 0;
        let food = { x: 15, y: 15 };
        let lastTime = 0;
        let isGameOver = false;

        const colors = ['#ff0000','#ff7f00','#ffff00','#00ff00','#0000ff','#4b0082','#9400d3'];

        // --- GAME LOOP ---
        function gameLoop(currentTime) {
            if(isGameOver) return;

            const deltaTime = currentTime - lastTime;
            const interval = 1000 / speed;

            if(deltaTime > interval){
                lastTime = currentTime - (deltaTime % interval);
                updateGame();
                drawGame();
            }

            requestAnimationFrame(gameLoop);
        }

        // --- UPDATE GAME ---
        function updateGame() {
            dx = newDx; dy = newDy;

            const headX = snake[0].x + dx;
            const headY = snake[0].y + dy;

            // Wall collision
            if(headX < 0 || headX >= tileCount || headY < 0 || headY >= tileCount){
                gameOver();
                return;
            }

            // Self collision
            for(let i=1; i<snake.length; i++){
                if(headX === snake[i].x && headY === snake[i].y){
                    gameOver();
                    return;
                }
            }

            // Move snake
            snake.unshift({x: headX, y: headY});

            // Food collision
            if(headX === food.x && headY === food.y){
                score++;
                scoreElement.textContent = `Score: ${score}`;
                placeFood();
                updateSpeed(); // Gradually increase speed
            } else {
                snake.pop();
            }
        }

        // --- DRAW GAME ---
        function drawGame() {
            ctx.fillStyle = '#c5e1a5';
            ctx.fillRect(0,0,canvas.width,canvas.height);

            // Draw snake with rainbow effect
            snake.forEach((segment,index)=>{
                ctx.fillStyle = colors[index % colors.length];
                ctx.fillRect(segment.x * tileSize, segment.y * tileSize, tileSize-1, tileSize-1);
            });

            // Draw food
            ctx.fillStyle = '#ff5722';
            ctx.fillRect(food.x*tileSize, food.y*tileSize, tileSize-1, tileSize-1);
        }

        // --- PLACE FOOD ---
        function placeFood(){
            let newFoodX, newFoodY, onSnake;
            do {
                newFoodX = Math.floor(Math.random()*tileCount);
                newFoodY = Math.floor(Math.random()*tileCount);
                onSnake = snake.some(s => s.x===newFoodX && s.y===newFoodY);
            } while(onSnake);
            food = {x: newFoodX, y: newFoodY};
        }

        // --- GAME OVER ---
        function gameOver(){
            isGameOver = true;
            ctx.fillStyle = 'red';
            ctx.font = '30px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Game Over!', canvas.width/2, canvas.height/2);
            ctx.font = '20px Arial';
            ctx.fillText(`Final Score: ${score}`, canvas.width/2, canvas.height/2 + 35);
        }

        // --- SPEED UPDATE ---
        function updateSpeed(){
            if(score>0 && score % 5 === 0){
                speed = Math.min(speed+1,15);
            }
        }

        // --- BUTTON FUNCTIONS ---
        function setDirection(direction){
            if(direction==='Up' && newDy===0){ newDx=0; newDy=-1; }
            else if(direction==='Down' && newDy===0){ newDx=0; newDy=1; }
            else if(direction==='Left' && newDx===0){ newDx=-1; newDy=0; }
            else if(direction==='Right' && newDx===0){ newDx=1; newDy=0; }
        }

        function restartGame(){
            snake = [{x:10,y:10}];
            dx=1; dy=0; newDx=1; newDy=0;
            score=0;
            scoreElement.textContent = `Score: ${score}`;
            placeFood();
            isGameOver = false;
            speed = 3; // reset slow speed
            requestAnimationFrame(gameLoop);
        }

        function chooseLevel(){
            let level = prompt("Choose Level: 1-Easy 2-Medium 3-Hard","1");
            if(level==="1") speed=3;
            else if(level==="2") speed=5;
            else if(level==="3") speed=8;
            else alert("Invalid choice! Using Medium speed.");
        }

        // --- KEYBOARD INPUT ---
        document.addEventListener('keydown', function(event){
            const key = event.key;
            if(key==='w' || key==='ArrowUp') setDirection('Up');
            else if() setDirection('Down');
            else if(key==='a' || key==='ArrowLeft') setDirection('Left');
            else if(key==='d' || key==='ArrowRight') setDirection('Right');
        });

        // --- START GAME ---
        requestAnimationFrame(gameLoop);

    </script>

</body>
</html>
